"""Palette handling: CLUT chunks and system palettes (Mac / Windows).

Director 5/6 uses platform-specific system palettes for palette IDs ≤ 0.
Palette ID -100 = Windows system palette, ID 0 = Mac system palette.
Custom palettes (ID > 0) reference a palette CastMember.
"""

from __future__ import annotations

import logging

log = logging.getLogger(__name__)

# ---------------------------------------------------------------------------
# System palette data (256 entries × RGBA with 4 bytes each → 1024 bytes)
# Extracted directly from ShockwaveParser.py PALETTE_MAC / PALETTE_WIN.
# Format: flat list of [R, G, B, 0, R, G, B, 0, ...] (4 bytes per entry).
# We convert these to [(R,G,B), ...] tuples on module load.
# ---------------------------------------------------------------------------

_PALETTE_MAC_RAW: list[int] = [
    0x00,
    0x00,
    0x00,
    0x00,
    0x11,
    0x11,
    0x11,
    0x00,
    0x22,
    0x22,
    0x22,
    0x00,
    0x44,
    0x44,
    0x44,
    0x00,
    0x55,
    0x55,
    0x55,
    0x00,
    0x77,
    0x77,
    0x77,
    0x00,
    0x88,
    0x88,
    0x88,
    0x00,
    0xAA,
    0xAA,
    0xAA,
    0x00,
    0xBB,
    0xBB,
    0xBB,
    0x00,
    0xDD,
    0xDD,
    0xDD,
    0x00,
    0xEE,
    0xEE,
    0xEE,
    0x00,
    0x11,
    0x00,
    0x00,
    0x00,
    0x22,
    0x00,
    0x00,
    0x00,
    0x44,
    0x00,
    0x00,
    0x00,
    0x55,
    0x00,
    0x00,
    0x00,
    0x77,
    0x00,
    0x00,
    0x00,
    0x88,
    0x00,
    0x00,
    0x00,
    0xAA,
    0x00,
    0x00,
    0x00,
    0xBB,
    0x00,
    0x00,
    0x00,
    0xDD,
    0x00,
    0x00,
    0x00,
    0xEE,
    0x00,
    0x00,
    0x00,
    0x00,
    0x11,
    0x00,
    0x00,
    0x00,
    0x22,
    0x00,
    0x00,
    0x00,
    0x44,
    0x00,
    0x00,
    0x00,
    0x55,
    0x00,
    0x00,
    0x00,
    0x77,
    0x00,
    0x00,
    0x00,
    0x88,
    0x00,
    0x00,
    0x00,
    0xAA,
    0x00,
    0x00,
    0x00,
    0xBB,
    0x00,
    0x00,
    0x00,
    0xDD,
    0x00,
    0x00,
    0x00,
    0xEE,
    0x00,
    0x00,
    0x00,
    0x00,
    0x11,
    0x00,
    0x00,
    0x00,
    0x22,
    0x00,
    0x00,
    0x00,
    0x44,
    0x00,
    0x00,
    0x00,
    0x55,
    0x00,
    0x00,
    0x00,
    0x77,
    0x00,
    0x00,
    0x00,
    0x88,
    0x00,
    0x00,
    0x00,
    0xAA,
    0x00,
    0x00,
    0x00,
    0xBB,
    0x00,
    0x00,
    0x00,
    0xDD,
    0x00,
    0x00,
    0x00,
    0xEE,
    0x00,
    0x33,
    0x00,
    0x00,
    0x00,
    0x66,
    0x00,
    0x00,
    0x00,
    0x99,
    0x00,
    0x00,
    0x00,
    0xCC,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0x00,
    0x33,
    0x00,
    0x00,
    0x33,
    0x33,
    0x00,
    0x00,
    0x66,
    0x33,
    0x00,
    0x00,
    0x99,
    0x33,
    0x00,
    0x00,
    0xCC,
    0x33,
    0x00,
    0x00,
    0xFF,
    0x33,
    0x00,
    0x00,
    0x00,
    0x66,
    0x00,
    0x00,
    0x33,
    0x66,
    0x00,
    0x00,
    0x66,
    0x66,
    0x00,
    0x00,
    0x99,
    0x66,
    0x00,
    0x00,
    0xCC,
    0x66,
    0x00,
    0x00,
    0xFF,
    0x66,
    0x00,
    0x00,
    0x00,
    0x99,
    0x00,
    0x00,
    0x33,
    0x99,
    0x00,
    0x00,
    0x66,
    0x99,
    0x00,
    0x00,
    0x99,
    0x99,
    0x00,
    0x00,
    0xCC,
    0x99,
    0x00,
    0x00,
    0xFF,
    0x99,
    0x00,
    0x00,
    0x00,
    0xCC,
    0x00,
    0x00,
    0x33,
    0xCC,
    0x00,
    0x00,
    0x66,
    0xCC,
    0x00,
    0x00,
    0x99,
    0xCC,
    0x00,
    0x00,
    0xCC,
    0xCC,
    0x00,
    0x00,
    0xFF,
    0xCC,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x33,
    0xFF,
    0x00,
    0x00,
    0x66,
    0xFF,
    0x00,
    0x00,
    0x99,
    0xFF,
    0x00,
    0x00,
    0xCC,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0x00,
    0x00,
    0x33,
    0x00,
    0x33,
    0x00,
    0x33,
    0x00,
    0x66,
    0x00,
    0x33,
    0x00,
    0x99,
    0x00,
    0x33,
    0x00,
    0xCC,
    0x00,
    0x33,
    0x00,
    0xFF,
    0x00,
    0x33,
    0x00,
    0x00,
    0x33,
    0x33,
    0x00,
    0x33,
    0x33,
    0x33,
    0x00,
    0x66,
    0x33,
    0x33,
    0x00,
    0x99,
    0x33,
    0x33,
    0x00,
    0xCC,
    0x33,
    0x33,
    0x00,
    0xFF,
    0x33,
    0x33,
    0x00,
    0x00,
    0x66,
    0x33,
    0x00,
    0x33,
    0x66,
    0x33,
    0x00,
    0x66,
    0x66,
    0x33,
    0x00,
    0x99,
    0x66,
    0x33,
    0x00,
    0xCC,
    0x66,
    0x33,
    0x00,
    0xFF,
    0x66,
    0x33,
    0x00,
    0x00,
    0x99,
    0x33,
    0x00,
    0x33,
    0x99,
    0x33,
    0x00,
    0x66,
    0x99,
    0x33,
    0x00,
    0x99,
    0x99,
    0x33,
    0x00,
    0xCC,
    0x99,
    0x33,
    0x00,
    0xFF,
    0x99,
    0x33,
    0x00,
    0x00,
    0xCC,
    0x33,
    0x00,
    0x33,
    0xCC,
    0x33,
    0x00,
    0x66,
    0xCC,
    0x33,
    0x00,
    0x99,
    0xCC,
    0x33,
    0x00,
    0xCC,
    0xCC,
    0x33,
    0x00,
    0xFF,
    0xCC,
    0x33,
    0x00,
    0x00,
    0xFF,
    0x33,
    0x00,
    0x33,
    0xFF,
    0x33,
    0x00,
    0x66,
    0xFF,
    0x33,
    0x00,
    0x99,
    0xFF,
    0x33,
    0x00,
    0xCC,
    0xFF,
    0x33,
    0x00,
    0xFF,
    0xFF,
    0x33,
    0x00,
    0x00,
    0x00,
    0x66,
    0x00,
    0x33,
    0x00,
    0x66,
    0x00,
    0x66,
    0x00,
    0x66,
    0x00,
    0x99,
    0x00,
    0x66,
    0x00,
    0xCC,
    0x00,
    0x66,
    0x00,
    0xFF,
    0x00,
    0x66,
    0x00,
    0x00,
    0x33,
    0x66,
    0x00,
    0x33,
    0x33,
    0x66,
    0x00,
    0x66,
    0x33,
    0x66,
    0x00,
    0x99,
    0x33,
    0x66,
    0x00,
    0xCC,
    0x33,
    0x66,
    0x00,
    0xFF,
    0x33,
    0x66,
    0x00,
    0x00,
    0x66,
    0x66,
    0x00,
    0x33,
    0x66,
    0x66,
    0x00,
    0x66,
    0x66,
    0x66,
    0x00,
    0x99,
    0x66,
    0x66,
    0x00,
    0xCC,
    0x66,
    0x66,
    0x00,
    0xFF,
    0x66,
    0x66,
    0x00,
    0x00,
    0x99,
    0x66,
    0x00,
    0x33,
    0x99,
    0x66,
    0x00,
    0x66,
    0x99,
    0x66,
    0x00,
    0x99,
    0x99,
    0x66,
    0x00,
    0xCC,
    0x99,
    0x66,
    0x00,
    0xFF,
    0x99,
    0x66,
    0x00,
    0x00,
    0xCC,
    0x66,
    0x00,
    0x33,
    0xCC,
    0x66,
    0x00,
    0x66,
    0xCC,
    0x66,
    0x00,
    0x99,
    0xCC,
    0x66,
    0x00,
    0xCC,
    0xCC,
    0x66,
    0x00,
    0xFF,
    0xCC,
    0x66,
    0x00,
    0x00,
    0xFF,
    0x66,
    0x00,
    0x33,
    0xFF,
    0x66,
    0x00,
    0x66,
    0xFF,
    0x66,
    0x00,
    0x99,
    0xFF,
    0x66,
    0x00,
    0xCC,
    0xFF,
    0x66,
    0x00,
    0xFF,
    0xFF,
    0x66,
    0x00,
    0x00,
    0x00,
    0x99,
    0x00,
    0x33,
    0x00,
    0x99,
    0x00,
    0x66,
    0x00,
    0x99,
    0x00,
    0x99,
    0x00,
    0x99,
    0x00,
    0xCC,
    0x00,
    0x99,
    0x00,
    0xFF,
    0x00,
    0x99,
    0x00,
    0x00,
    0x33,
    0x99,
    0x00,
    0x33,
    0x33,
    0x99,
    0x00,
    0x66,
    0x33,
    0x99,
    0x00,
    0x99,
    0x33,
    0x99,
    0x00,
    0xCC,
    0x33,
    0x99,
    0x00,
    0xFF,
    0x33,
    0x99,
    0x00,
    0x00,
    0x66,
    0x99,
    0x00,
    0x33,
    0x66,
    0x99,
    0x00,
    0x66,
    0x66,
    0x99,
    0x00,
    0x99,
    0x66,
    0x99,
    0x00,
    0xCC,
    0x66,
    0x99,
    0x00,
    0xFF,
    0x66,
    0x99,
    0x00,
    0x00,
    0x99,
    0x99,
    0x00,
    0x33,
    0x99,
    0x99,
    0x00,
    0x66,
    0x99,
    0x99,
    0x00,
    0x99,
    0x99,
    0x99,
    0x00,
    0xCC,
    0x99,
    0x99,
    0x00,
    0xFF,
    0x99,
    0x99,
    0x00,
    0x00,
    0xCC,
    0x99,
    0x00,
    0x33,
    0xCC,
    0x99,
    0x00,
    0x66,
    0xCC,
    0x99,
    0x00,
    0x99,
    0xCC,
    0x99,
    0x00,
    0xCC,
    0xCC,
    0x99,
    0x00,
    0xFF,
    0xCC,
    0x99,
    0x00,
    0x00,
    0xFF,
    0x99,
    0x00,
    0x33,
    0xFF,
    0x99,
    0x00,
    0x66,
    0xFF,
    0x99,
    0x00,
    0x99,
    0xFF,
    0x99,
    0x00,
    0xCC,
    0xFF,
    0x99,
    0x00,
    0xFF,
    0xFF,
    0x99,
    0x00,
    0x00,
    0x00,
    0xCC,
    0x00,
    0x33,
    0x00,
    0xCC,
    0x00,
    0x66,
    0x00,
    0xCC,
    0x00,
    0x99,
    0x00,
    0xCC,
    0x00,
    0xCC,
    0x00,
    0xCC,
    0x00,
    0xFF,
    0x00,
    0xCC,
    0x00,
    0x00,
    0x33,
    0xCC,
    0x00,
    0x33,
    0x33,
    0xCC,
    0x00,
    0x66,
    0x33,
    0xCC,
    0x00,
    0x99,
    0x33,
    0xCC,
    0x00,
    0xCC,
    0x33,
    0xCC,
    0x00,
    0xFF,
    0x33,
    0xCC,
    0x00,
    0x00,
    0x66,
    0xCC,
    0x00,
    0x33,
    0x66,
    0xCC,
    0x00,
    0x66,
    0x66,
    0xCC,
    0x00,
    0x99,
    0x66,
    0xCC,
    0x00,
    0xCC,
    0x66,
    0xCC,
    0x00,
    0xFF,
    0x66,
    0xCC,
    0x00,
    0x00,
    0x99,
    0xCC,
    0x00,
    0x33,
    0x99,
    0xCC,
    0x00,
    0x66,
    0x99,
    0xCC,
    0x00,
    0x99,
    0x99,
    0xCC,
    0x00,
    0xCC,
    0x99,
    0xCC,
    0x00,
    0xFF,
    0x99,
    0xCC,
    0x00,
    0x00,
    0xCC,
    0xCC,
    0x00,
    0x33,
    0xCC,
    0xCC,
    0x00,
    0x66,
    0xCC,
    0xCC,
    0x00,
    0x99,
    0xCC,
    0xCC,
    0x00,
    0xCC,
    0xCC,
    0xCC,
    0x00,
    0xFF,
    0xCC,
    0xCC,
    0x00,
    0x00,
    0xFF,
    0xCC,
    0x00,
    0x33,
    0xFF,
    0xCC,
    0x00,
    0x66,
    0xFF,
    0xCC,
    0x00,
    0x99,
    0xFF,
    0xCC,
    0x00,
    0xCC,
    0xFF,
    0xCC,
    0x00,
    0xFF,
    0xFF,
    0xCC,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x33,
    0x00,
    0xFF,
    0x00,
    0x66,
    0x00,
    0xFF,
    0x00,
    0x99,
    0x00,
    0xFF,
    0x00,
    0xCC,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x33,
    0xFF,
    0x00,
    0x33,
    0x33,
    0xFF,
    0x00,
    0x66,
    0x33,
    0xFF,
    0x00,
    0x99,
    0x33,
    0xFF,
    0x00,
    0xCC,
    0x33,
    0xFF,
    0x00,
    0xFF,
    0x33,
    0xFF,
    0x00,
    0x00,
    0x66,
    0xFF,
    0x00,
    0x33,
    0x66,
    0xFF,
    0x00,
    0x66,
    0x66,
    0xFF,
    0x00,
    0x99,
    0x66,
    0xFF,
    0x00,
    0xCC,
    0x66,
    0xFF,
    0x00,
    0xFF,
    0x66,
    0xFF,
    0x00,
    0x00,
    0x99,
    0xFF,
    0x00,
    0x33,
    0x99,
    0xFF,
    0x00,
    0x66,
    0x99,
    0xFF,
    0x00,
    0x99,
    0x99,
    0xFF,
    0x00,
    0xCC,
    0x99,
    0xFF,
    0x00,
    0xFF,
    0x99,
    0xFF,
    0x00,
    0x00,
    0xCC,
    0xFF,
    0x00,
    0x33,
    0xCC,
    0xFF,
    0x00,
    0x66,
    0xCC,
    0xFF,
    0x00,
    0x99,
    0xCC,
    0xFF,
    0x00,
    0xCC,
    0xCC,
    0xFF,
    0x00,
    0xFF,
    0xCC,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x33,
    0xFF,
    0xFF,
    0x00,
    0x66,
    0xFF,
    0xFF,
    0x00,
    0x99,
    0xFF,
    0xFF,
    0x00,
    0xCC,
    0xFF,
    0xFF,
    0x00,
    0xFF,
    0xFF,
    0xFF,
    0x00,
]

_PALETTE_WIN_RAW: list[int] = [
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0x00,
    0xBF,
    0x00,
    0x00,
    0xBF,
    0x00,
    0x00,
    0x00,
    0xBF,
    0xBF,
    0x00,
    0xBF,
    0x00,
    0x00,
    0x00,
    0xBF,
    0x00,
    0xBF,
    0x00,
    0xBF,
    0xBF,
    0x00,
    0x00,
    0xC0,
    0xC0,
    0xC0,
    0x00,
    0xC0,
    0xDC,
    0xC0,
    0x00,
    0xF0,
    0xC8,
    0xA4,
    0x00,
    0xF0,
    0xF0,
    0xF0,
    0x00,
    0x99,
    0xFF,
    0xFF,
    0x00,
    0x99,
    0xD4,
    0x99,
    0x00,
    0xFF,
    0xD4,
    0x99,
    0x00,
    0xFF,
    0xCC,
    0xFF,
    0x00,
    0x99,
    0x99,
    0xFF,
    0x00,
    0x30,
    0x22,
    0x22,
    0x00,
    0x11,
    0x00,
    0x00,
    0x00,
    0x22,
    0x00,
    0x00,
    0x00,
    0x44,
    0x00,
    0x00,
    0x00,
    0x55,
    0x00,
    0x00,
    0x00,
    0x77,
    0x00,
    0x00,
    0x00,
    0x88,
    0x00,
    0x00,
    0x00,
    0xAA,
    0x00,
    0x00,
    0x00,
    0xDD,
    0x00,
    0x00,
    0x00,
    0xEE,
    0x00,
    0x00,
    0x00,
    0x00,
    0x11,
    0x00,
    0x00,
    0x00,
    0x22,
    0x00,
    0x00,
    0x00,
    0x44,
    0x00,
    0x00,
    0x00,
    0x55,
    0x00,
    0x00,
    0x00,
    0x77,
    0x00,
    0x00,
    0x00,
    0x88,
    0x00,
    0x00,
    0x00,
    0xAA,
    0x00,
    0x00,
    0x00,
    0xDD,
    0x00,
    0x00,
    0x00,
    0xEE,
    0x00,
    0x00,
    0x00,
    0x00,
    0x11,
    0x00,
    0x00,
    0x00,
    0x22,
    0x00,
    0x00,
    0x00,
    0x44,
    0x00,
    0x00,
    0x00,
    0x55,
    0x00,
    0x00,
    0x00,
    0x77,
    0x00,
    0x00,
    0x00,
    0x90,
    0x00,
    0x00,
    0x00,
    0xAA,
    0x00,
    0x00,
    0x00,
    0xDD,
    0x00,
    0x00,
    0x00,
    0xEE,
    0x00,
    0x33,
    0x00,
    0x00,
    0x00,
    0x66,
    0x00,
    0x00,
    0x00,
    0x99,
    0x00,
    0x00,
    0x00,
    0xCC,
    0x00,
    0x00,
    0x00,
    0x00,
    0x33,
    0x00,
    0x00,
    0x33,
    0x33,
    0x00,
    0x00,
    0x66,
    0x33,
    0x00,
    0x00,
    0xA1,
    0x33,
    0x00,
    0x00,
    0xCC,
    0x33,
    0x00,
    0x00,
    0xFF,
    0x33,
    0x00,
    0x00,
    0x00,
    0x66,
    0x00,
    0x00,
    0x33,
    0x66,
    0x00,
    0x00,
    0x66,
    0x66,
    0x00,
    0x00,
    0x99,
    0x66,
    0x00,
    0x00,
    0xCC,
    0x66,
    0x00,
    0x00,
    0xFF,
    0x66,
    0x00,
    0x00,
    0x00,
    0x99,
    0x00,
    0x00,
    0x33,
    0x99,
    0x00,
    0x00,
    0x66,
    0x99,
    0x00,
    0x00,
    0x99,
    0x99,
    0x00,
    0x00,
    0xCC,
    0x99,
    0x00,
    0x00,
    0xFF,
    0x99,
    0x00,
    0x00,
    0x00,
    0xCC,
    0x00,
    0x00,
    0x33,
    0xCC,
    0x00,
    0x00,
    0x66,
    0xCC,
    0x00,
    0x00,
    0x99,
    0xCC,
    0x00,
    0x00,
    0xCC,
    0xCC,
    0x00,
    0x00,
    0xFF,
    0xCC,
    0x00,
    0x00,
    0x33,
    0xFF,
    0x00,
    0x00,
    0x66,
    0xFF,
    0x00,
    0x00,
    0x99,
    0xFF,
    0x00,
    0x00,
    0xCC,
    0xFF,
    0x00,
    0x00,
    0x00,
    0x00,
    0x33,
    0x00,
    0x33,
    0x00,
    0x33,
    0x00,
    0x66,
    0x00,
    0x33,
    0x00,
    0x99,
    0x00,
    0x33,
    0x00,
    0xCC,
    0x00,
    0x33,
    0x00,
    0xFF,
    0x00,
    0x33,
    0x00,
    0x00,
    0x33,
    0x33,
    0x00,
    0x3B,
    0x33,
    0x33,
    0x00,
    0x66,
    0x33,
    0x33,
    0x00,
    0x99,
    0x33,
    0x33,
    0x00,
    0xCC,
    0x33,
    0x33,
    0x00,
    0xFF,
    0x33,
    0x33,
    0x00,
    0x00,
    0x66,
    0x33,
    0x00,
    0x33,
    0x6E,
    0x33,
    0x00,
    0x66,
    0x66,
    0x33,
    0x00,
    0x99,
    0x66,
    0x33,
    0x00,
    0xCC,
    0x66,
    0x33,
    0x00,
    0xFF,
    0x66,
    0x33,
    0x00,
    0x00,
    0x99,
    0x33,
    0x00,
    0x33,
    0x99,
    0x33,
    0x00,
    0x66,
    0x99,
    0x33,
    0x00,
    0x99,
    0x99,
    0x33,
    0x00,
    0xCC,
    0x99,
    0x33,
    0x00,
    0xFF,
    0x99,
    0x33,
    0x00,
    0x00,
    0xCC,
    0x33,
    0x00,
    0x33,
    0xCC,
    0x33,
    0x00,
    0x66,
    0xCC,
    0x33,
    0x00,
    0x99,
    0xCC,
    0x33,
    0x00,
    0xCC,
    0xCC,
    0x33,
    0x00,
    0xFF,
    0xCC,
    0x33,
    0x00,
    0x00,
    0xFF,
    0x33,
    0x00,
    0x33,
    0xFF,
    0x33,
    0x00,
    0x66,
    0xFF,
    0x33,
    0x00,
    0x99,
    0xFF,
    0x33,
    0x00,
    0xCC,
    0xFF,
    0x33,
    0x00,
    0xFF,
    0xFF,
    0x33,
    0x00,
    0x00,
    0x00,
    0x66,
    0x00,
    0x33,
    0x00,
    0x66,
    0x00,
    0x66,
    0x00,
    0x66,
    0x00,
    0x99,
    0x00,
    0x66,
    0x00,
    0xCC,
    0x00,
    0x66,
    0x00,
    0xFF,
    0x00,
    0x66,
    0x00,
    0x00,
    0x33,
    0x66,
    0x00,
    0x33,
    0x33,
    0x66,
    0x00,
    0x66,
    0x33,
    0x66,
    0x00,
    0x99,
    0x33,
    0x66,
    0x00,
    0xCC,
    0x33,
    0x66,
    0x00,
    0xFF,
    0x33,
    0x66,
    0x00,
    0x00,
    0x66,
    0x66,
    0x00,
    0x33,
    0x66,
    0x66,
    0x00,
    0x66,
    0x66,
    0x66,
    0x00,
    0x99,
    0x66,
    0x66,
    0x00,
    0xCC,
    0x66,
    0x66,
    0x00,
    0xFF,
    0x66,
    0x66,
    0x00,
    0x00,
    0x99,
    0x66,
    0x00,
    0x33,
    0x99,
    0x66,
    0x00,
    0x66,
    0x99,
    0x66,
    0x00,
    0x99,
    0x99,
    0x66,
    0x00,
    0xCC,
    0x99,
    0x66,
    0x00,
    0xFF,
    0x99,
    0x66,
    0x00,
    0x00,
    0xCC,
    0x66,
    0x00,
    0x33,
    0xCC,
    0x66,
    0x00,
    0x66,
    0xCC,
    0x66,
    0x00,
    0x99,
    0xCC,
    0x66,
    0x00,
    0xCC,
    0xCC,
    0x66,
    0x00,
    0xFF,
    0xCC,
    0x66,
    0x00,
    0x00,
    0xFF,
    0x66,
    0x00,
    0x33,
    0xFF,
    0x66,
    0x00,
    0x66,
    0xFF,
    0x66,
    0x00,
    0x99,
    0xFF,
    0x66,
    0x00,
    0xCC,
    0xFF,
    0x66,
    0x00,
    0xFF,
    0xFF,
    0x66,
    0x00,
    0x00,
    0x00,
    0x99,
    0x00,
    0x33,
    0x00,
    0x99,
    0x00,
    0x66,
    0x00,
    0x99,
    0x00,
    0x99,
    0x00,
    0x99,
    0x00,
    0xCC,
    0x00,
    0x99,
    0x00,
    0xFF,
    0x00,
    0x99,
    0x00,
    0x00,
    0x33,
    0x99,
    0x00,
    0x33,
    0x33,
    0x99,
    0x00,
    0x66,
    0x33,
    0x99,
    0x00,
    0x99,
    0x33,
    0x99,
    0x00,
    0xCC,
    0x33,
    0x99,
    0x00,
    0xFF,
    0x33,
    0x99,
    0x00,
    0x00,
    0x66,
    0xA1,
    0x00,
    0x33,
    0x66,
    0x99,
    0x00,
    0x66,
    0x66,
    0x99,
    0x00,
    0x99,
    0x66,
    0x99,
    0x00,
    0xCC,
    0x66,
    0x99,
    0x00,
    0xFF,
    0x66,
    0x99,
    0x00,
    0x00,
    0x99,
    0x99,
    0x00,
    0x33,
    0x99,
    0x99,
    0x00,
    0x66,
    0x99,
    0x99,
    0x00,
    0x99,
    0x99,
    0x99,
    0x00,
    0xCC,
    0x99,
    0x99,
    0x00,
    0xFF,
    0x99,
    0x99,
    0x00,
    0x00,
    0xCC,
    0x99,
    0x00,
    0x33,
    0xCC,
    0x99,
    0x00,
    0x66,
    0xCC,
    0x99,
    0x00,
    0x99,
    0xCC,
    0x99,
    0x00,
    0xCC,
    0xCC,
    0x99,
    0x00,
    0xFF,
    0xCC,
    0x99,
    0x00,
    0x00,
    0xFF,
    0x99,
    0x00,
    0x33,
    0xFF,
    0x99,
    0x00,
    0x66,
    0xFF,
    0x99,
    0x00,
    0x99,
    0xFF,
    0x99,
    0x00,
    0xCC,
    0xFF,
    0x99,
    0x00,
    0xFF,
    0xFF,
    0x99,
    0x00,
    0x00,
    0x00,
    0xCC,
    0x00,
    0x33,
    0x00,
    0xCC,
    0x00,
    0x66,
    0x00,
    0xCC,
    0x00,
    0x99,
    0x00,
    0xCC,
    0x00,
    0xCC,
    0x00,
    0xCC,
    0x00,
    0xFF,
    0x08,
    0xD4,
    0x00,
    0x00,
    0x33,
    0xCC,
    0x00,
    0x33,
    0x33,
    0xCC,
    0x00,
    0x66,
    0x33,
    0xCC,
    0x00,
    0x99,
    0x33,
    0xCC,
    0x00,
    0xCC,
    0x33,
    0xCC,
    0x00,
    0xFF,
    0x33,
    0xCC,
    0x00,
    0x00,
    0x66,
    0xCC,
    0x00,
    0x33,
    0x66,
    0xCC,
    0x00,
    0x66,
    0x66,
    0xCC,
    0x00,
    0x99,
    0x66,
    0xCC,
    0x00,
    0xCC,
    0x66,
    0xCC,
    0x00,
    0xFF,
    0x66,
    0xCC,
    0x00,
    0x00,
    0x99,
    0xCC,
    0x00,
    0x33,
    0x99,
    0xCC,
    0x00,
    0x66,
    0x99,
    0xCC,
    0x00,
    0x99,
    0x99,
    0xCC,
    0x00,
    0xCC,
    0x99,
    0xCC,
    0x00,
    0xFF,
    0x99,
    0xCC,
    0x00,
    0x00,
    0xCC,
    0xCC,
    0x00,
    0x33,
    0xCC,
    0xCC,
    0x00,
    0x66,
    0xCC,
    0xCC,
    0x00,
    0x99,
    0xCC,
    0xCC,
    0x00,
    0xCC,
    0xCC,
    0xCC,
    0x00,
    0xFF,
    0xCC,
    0xCC,
    0x00,
    0x00,
    0xFF,
    0xCC,
    0x00,
    0x33,
    0xFF,
    0xCC,
    0x00,
    0x66,
    0xFF,
    0xCC,
    0x00,
    0x99,
    0xFF,
    0xCC,
    0x00,
    0xCC,
    0xFF,
    0xCC,
    0x00,
    0xFF,
    0xFF,
    0xCC,
    0x00,
    0x33,
    0x00,
    0xFF,
    0x00,
    0x66,
    0x00,
    0xFF,
    0x00,
    0x99,
    0x00,
    0xFF,
    0x00,
    0xCC,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x33,
    0xFF,
    0x00,
    0x33,
    0x33,
    0xFF,
    0x00,
    0x66,
    0x33,
    0xFF,
    0x00,
    0x99,
    0x33,
    0xFF,
    0x00,
    0xCC,
    0x33,
    0xFF,
    0x00,
    0xFF,
    0x33,
    0xFF,
    0x00,
    0x00,
    0x66,
    0xFF,
    0x00,
    0x33,
    0x66,
    0xFF,
    0x00,
    0x66,
    0x66,
    0xFF,
    0x00,
    0x99,
    0x66,
    0xFF,
    0x00,
    0xCC,
    0x66,
    0xFF,
    0x00,
    0xFF,
    0x66,
    0xFF,
    0x00,
    0x00,
    0x99,
    0xFF,
    0x00,
    0xDD,
    0xDD,
    0xDD,
    0x00,
    0xCC,
    0x99,
    0xFF,
    0x00,
    0x66,
    0xCC,
    0xFF,
    0x00,
    0x00,
    0x00,
    0x88,
    0x00,
    0xFF,
    0x00,
    0xCC,
    0x00,
    0x99,
    0x33,
    0x00,
    0x00,
    0x33,
    0x66,
    0x33,
    0x00,
    0x00,
    0x66,
    0x99,
    0x00,
    0x33,
    0x33,
    0x33,
    0x00,
    0xF0,
    0xFB,
    0xFF,
    0x00,
    0xA4,
    0xA0,
    0xA0,
    0x00,
    0x80,
    0x80,
    0x80,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0x00,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0x00,
    0xFF,
    0xFF,
    0x00,
    0x00,
    0xFF,
    0xFF,
    0xFF,
    0x00,
]


def _raw_to_tuples(raw: list[int]) -> list[tuple[int, int, int]]:
    """Convert flat [R,G,B,0, R,G,B,0, ...] to [(R,G,B), ...]."""
    result = []
    for i in range(0, len(raw), 4):
        result.append((raw[i], raw[i + 1], raw[i + 2]))
    return result


# Pre-computed system palettes
PALETTE_MAC: list[tuple[int, int, int]] = _raw_to_tuples(_PALETTE_MAC_RAW)
PALETTE_WIN: list[tuple[int, int, int]] = _raw_to_tuples(_PALETTE_WIN_RAW)


def get_system_palette(palette_id: int) -> list[tuple[int, int, int]] | None:
    """Get a system palette by Director palette ID.

    palette_id <= 0 denotes a system palette:
      0   → Mac system palette
      -100 → Windows system palette (Dir 4+)
    """
    pid = -palette_id if palette_id < 0 else palette_id
    if pid == 0:
        return PALETTE_MAC
    elif pid == 100:
        return PALETTE_WIN
    return None
